# fuzzy search for files/directories and open that in nvim
# If a file is chosen, cd's to that dir and opens the file
# If a dir is chosen, cd's there

function fzfedit() {
  local chosen_file
  local enclosing_dir
  chosen_file="$(fd --full-path -L -H | fzf +m --preview='${HOME}/.config/fzf_preview {}')"
  if [ ! $? -eq 0 ]; then  # if user didnt select file, exit
    return
  fi
  if [ -d "$chosen_file" ]; then
    cd "$chosen_file"
    zle && { zle reset-prompt; }  # change prompt to update PS1 with new CWD
  else
    enclosing_dir=`dirname "$chosen_file"`
    chosen_file=`basename "$chosen_file"`
    cd "$enclosing_dir"
    zle && { zle reset-prompt; }  # reset prompt to update PS1
    $EDITOR "$chosen_file"
    zle-keymap-select  # check vi mode to update cursor shape
  fi
}

