# Update typically used packages

function update() {
	local START_TIME=$(date +%s)
	wait-for-internet --text "(waiting for internet)"
	echo "Updating system (pacman/yay) packages..."
	yay -Syu
	echo "Updating pkgfile indexes..."
	sudo pkgfile --update
	yadm bootstrap
	echo "Updating nvim packages..."
	nvim +PlugUpdate +qall
	echo "Updating doom emacs..."
	doom -y upgrade
	echo "Updating ruby packages..."
	gem update
	echo "Updating python packages..."
	python3 -m pip list --no-cache-dir --outdated --format=freeze | cut -d"=" -f 1 | xargs -r -n1 python3 -m pip install --upgrade --user --no-deps
	echo "Updating global npm packages..."
	npm update -g
	echo "Updating global cargo packages..."
	cargo install-update -a
	echo "Updating global go packages..."
  go get -u -v $(cut -d" " -f2 "$HOME/.config/yadm/go_packages.txt") 2>&1 | grep "(download)$"
	printf "Finished updates in %d seconds\n" $(bc <<<"$(date +%s) - ${START_TIME}") | boxes -d shell -p t1l2b1r2
}
